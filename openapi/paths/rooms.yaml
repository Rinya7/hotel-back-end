# openapi/paths/rooms.yaml
rooms_all:
  get:
    security: [{ bearerAuth: [] }]
    tags: [Rooms]
    summary: Усі кімнати по системі (superadmin)
    responses:
      "200":
        description: OK
        content:
          application/json:
            schema:
              type: array
              items: { $ref: "../openapi.base.yaml#/components/schemas/Room" }

rooms_list_and_create:
  get:
    security: [{ bearerAuth: [] }]
    tags: [Rooms]
    summary: Список кімнат поточного готелю
    responses:
      "200":
        description: OK
        content:
          application/json:
            schema:
              type: array
              items: { $ref: "../openapi.base.yaml#/components/schemas/Room" }
  post:
    security: [{ bearerAuth: [] }]
    tags: [Rooms]
    summary: Створити кімнату
    requestBody:
      required: true
      content:
        application/json:
          schema:
            {
              $ref: "../openapi.base.yaml#/components/schemas/CreateRoomRequest",
            }
    responses:
      "201":
        description: Created
        content:
          application/json:
            schema:
              { $ref: "../openapi.base.yaml#/components/schemas/RoomResponse" }
      "400":
        description: Validation error
      "409":
        description: Duplicate room

rooms_by_status:
  get:
    security: [{ bearerAuth: [] }]
    tags: [Rooms]
    summary: Кімнати за статусом (free|booked|occupied)
    parameters:
      - name: status
        in: path
        required: true
        schema: { $ref: "../openapi.base.yaml#/components/schemas/RoomStatus" }
    responses:
      "200":
        description: OK

rooms_update_delete:
  put:
    security: [{ bearerAuth: [] }]
    tags: [Rooms]
    summary: Повне редагування кімнати за roomNumber
    parameters:
      - name: roomNumber
        in: path
        required: true
        schema: { type: string }
    requestBody:
      required: true
      content:
        application/json:
          schema:
            {
              $ref: "../openapi.base.yaml#/components/schemas/UpdateRoomRequest",
            }
    responses:
      "200":
        description: Updated
        content:
          application/json:
            schema:
              { $ref: "../openapi.base.yaml#/components/schemas/RoomResponse" }
      "404":
        description: Not found
      "409":
        description: Duplicate room number
  delete:
    security: [{ bearerAuth: [] }]
    tags: [Rooms]
    summary: Видалити кімнату
    parameters:
      - name: roomNumber
        in: path
        required: true
        schema: { type: string }
    responses:
      "200":
        description: Deleted
        content:
          application/json:
            schema:
              { $ref: "../openapi.base.yaml#/components/schemas/SimpleMessage" }
      "404":
        description: Not found

rooms_update_status:
  put:
    security: [{ bearerAuth: [] }]
    tags: [Rooms]
    summary: Ручна зміна статусу кімнати
    parameters:
      - name: roomNumber
        in: path
        required: true
        schema: { type: string }
    requestBody:
      required: true
      content:
        application/json:
          schema:
            {
              $ref: "../openapi.base.yaml#/components/schemas/RoomStatusUpdateRequest",
            }
    responses:
      "200":
        description: Updated

rooms_cleaned:
  patch:
    security: [{ bearerAuth: [] }]
    tags: [Rooms]
    summary: Позначити кімнату як прибрану (cleaning → free)
    parameters:
      - name: id
        in: path
        required: true
        schema: { type: integer }
    requestBody:
      required: false
      content:
        application/json:
          schema:
            type: object
            properties:
              notes:
                type: string
                nullable: true
                description: Коментар/нотатка про прибирання
    responses:
      "200":
        description: Room cleaned
        content:
          application/json:
            schema:
              type: object
              properties:
                message: { type: string }
                room: { $ref: "../openapi.base.yaml#/components/schemas/Room" }
      "400":
        description: Room is not in cleaning state
      "404":
        description: Room not found

rooms_history:
  get:
    security: [{ bearerAuth: [] }]
    tags: [Rooms]
    summary: Історія змін статусів кімнати
    parameters:
      - name: roomNumber
        in: path
        required: true
        schema: { type: string }
    responses:
      "200":
        description: OK
        content:
          application/json:
            schema:
              type: object
              properties:
                roomNumber: { type: string }
                logs:
                  type: array
                  items:
                    type: object
                    properties:
                      id: { type: integer }
                      oldStatus: { type: string }
                      newStatus: { type: string }
                      changedAt: { type: string, format: date-time }
                      changedBy:
                        type: string
                        nullable: true
                      changedByRole:
                        type: string
                        nullable: true
                        enum: [system, admin, editor]
                      stay:
                        nullable: true
                        type: object
                        properties:
                          id: { type: integer }
                          mainGuestName: { type: string }
                      entityLabel:
                        type: string
                        nullable: true
                      entityLink:
                        type: string
                        nullable: true
      "404":
        description: Room not found