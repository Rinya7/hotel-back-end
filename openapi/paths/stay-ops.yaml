# openapi/paths/stay-ops.yaml
stay_check_in:
  patch:
    security: [{ bearerAuth: [] }]
    tags: [Stay Ops]
    summary: Ручний check-in (booked → occupied або walk-in)
    parameters:
      - name: id
        in: path
        required: true
        schema: { type: integer }
    requestBody:
      required: false
      content:
        application/json:
          schema:
            type: object
            properties:
              comment:
                type: string
                nullable: true
                description: Коментар до логу (необов'язковий)
    responses:
      "200":
        description: OK
      "400":
        description: Room not available for check-in

stay_check_out:
  patch:
    security: [{ bearerAuth: [] }]
    tags: [Stay Ops]
    summary: Ручний check-out (occupied → completed → cleaning)
    parameters:
      - name: id
        in: path
        required: true
        schema: { type: integer }
    requestBody:
      required: false
      content:
        application/json:
          schema:
            type: object
            properties:
              comment:
                type: string
                nullable: true
                description: Коментар до логу (необов'язковий)
    responses:
      "200":
        description: OK
      "400":
        description: Stay must be occupied before check-out

stay_cancel:
  patch:
    security: [{ bearerAuth: [] }]
    tags: [Stay Ops]
    summary: Скасувати бронювання (booked → cancelled)
    parameters:
      - name: id
        in: path
        required: true
        schema: { type: integer }
    requestBody:
      required: false
      content:
        application/json:
          schema:
            type: object
            properties:
              comment:
                type: string
                nullable: true
                description: Коментар причини скасування
    responses:
      "200":
        description: OK
      "400":
        description: Only booked stay can be cancelled

stay_update_status:
  put:
    security: [{ bearerAuth: [] }]
    tags: [Stay Ops]
    summary: Оновити статус проживання (з автоматичною синхронізацією кімнати)
    parameters:
      - name: id
        in: path
        required: true
        schema: { type: integer }
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required: [status]
            properties:
              status:
                $ref: "../openapi.base.yaml#/components/schemas/StayStatus"
              comment:
                type: string
                nullable: true
                description: "Обов'язковий при статусі cancelled для адміністраторів/редакторів"
    responses:
      "200":
        description: OK